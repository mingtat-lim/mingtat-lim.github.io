"use strict";(globalThis["webpackChunkqr_generator"]=globalThis["webpackChunkqr_generator"]||[]).push([[773],{2875:(e,t,a)=>{function l(e,t,a){return e?`${t} ${a}`:t}a.d(t,{$:()=>l})},2620:(e,t,a)=>{a.d(t,{P:()=>o,d:()=>l});class l{constructor(e){this._settings={isAdmin:!1,globalDebug:!1,homePageDebug:!1,barCodePageDebug:!1,qrCodePageDebug:!1,profilePageDebug:!1,memberPageDebug:!1,eventsPageDebug:!1,scanCodePageDebug:!1,geolocationPageDebug:!1,settingsPageDebug:!1},this.DB_KEY="SETTINGS",this._local=e.localStorage,null===this._local.getItem(this.DB_KEY)&&this._local.set(this.DB_KEY,JSON.stringify(this.getState()));const t=JSON.parse(this._local.getItem(this.DB_KEY)+"");this._settings=Object.assign(Object.assign({},this._settings),t)}saveSettings(){this._local.set(this.DB_KEY,JSON.stringify(this.getState()))}getState(){return this._settings}get isAdmin(){return this._settings.isAdmin}set isAdmin(e){this._settings.isAdmin=e}get globalDebug(){return this._settings.globalDebug}set globalDebug(e){this._settings.globalDebug=e}get eventsPageDebug(){return this._settings.eventsPageDebug}set eventsPageDebug(e){this._settings.eventsPageDebug=e}get barCodePageDebug(){return this._settings.barCodePageDebug}set barCodePageDebug(e){this._settings.barCodePageDebug=e}get geolocationPageDebug(){return this._settings.geolocationPageDebug}set geolocationPageDebug(e){this._settings.geolocationPageDebug=e}get homePageDebug(){return this._settings.homePageDebug}set homePageDebug(e){this._settings.homePageDebug=e}get memberPageDebug(){return this._settings.memberPageDebug}set memberPageDebug(e){this._settings.memberPageDebug=e}get profilePageDebug(){return this._settings.profilePageDebug}set profilePageDebug(e){this._settings.profilePageDebug=e}get qrCodePageDebug(){return this._settings.qrCodePageDebug}set qrCodePageDebug(e){this._settings.qrCodePageDebug=e}get scanCodePageDebug(){return this._settings.scanCodePageDebug}set scanCodePageDebug(e){this._settings.scanCodePageDebug=e}get settingsPageDebug(){return this._settings.settingsPageDebug}set settingsPageDebug(e){this._settings.settingsPageDebug=e}}class o{constructor(e){this.KEY_BARCODE_DB="barcode-db",this._state={title:"条形码数据库",barCodes:[]},this._local=e.localStorage,null===this._local.getItem(this.KEY_BARCODE_DB)&&this._local.set(this.KEY_BARCODE_DB,JSON.stringify(this.getState()));const t=JSON.parse(this._local.getItem(this.KEY_BARCODE_DB)+"");this._state=Object.assign(Object.assign({},this._state),t)}getState(){return this._state}saveData(){this._local.set(this.KEY_BARCODE_DB,JSON.stringify(this.getState()))}get newItem(){return{caption:"",barCode:"",expanded:!1}}addBarCode(e){this._state.barCodes.push(e)}deleteBarCode(e){this._state.barCodes=[...this._state.barCodes.slice(0,e),...this._state.barCodes.slice(e+1)]}get title(){return this._state.title}get barCodes(){return this._state.barCodes}}},1435:(e,t,a)=>{a.d(t,{Z:()=>u});var l=a(9835),o=a(1265);const s={name:"BarcodeGenerator",props:{value:[String,Number],format:[String],width:[String,Number],height:[String,Number],displayValue:{type:[String,Boolean],default:!0},text:[String,Number],fontOptions:[String],font:[String],textAlign:[String],textPosition:[String],textMargin:[String,Number],fontSize:[String,Number],background:[String],lineColor:[String],margin:[String,Number],marginTop:[String,Number],marginBottom:[String,Number],marginLeft:[String,Number],marginRight:[String,Number],flat:[Boolean],ean128:[String,Boolean],elementTag:{type:String,default:"svg",validator:function(e){return-1!==["canvas","svg","img"].indexOf(e)}}},render(){return(0,l.h)(this.elementTag,{id:["barcodegen"]})},mounted:function(){i.call(this)}};function i(){this.value;var e={format:this.format,width:this.width,height:this.height,displayValue:this.displayValue,text:this.text,fontOptions:this.fontOptions,font:this.font,textAlign:this.textAlign,textPosition:this.textPosition,textMargin:this.textMargin,fontSize:this.fontSize,background:this.background,lineColor:this.lineColor,margin:this.margin,marginTop:this.marginTop,marginBottom:this.marginBottom,marginLeft:this.marginLeft,marginRight:this.marginRight,flat:this.flat,ean128:this.ean128,valid:function(e){e},elementTag:this.elementTag};n(e),o(this.$el,this.value,e)}function n(e){Object.keys(e).forEach((t=>void 0===e[t]?delete e[t]:{}))}const r=s,u=r},5773:(e,t,a)=>{a.r(t),a.d(t,{default:()=>V});var l=a(9835),o=a(6970),s=a(499),i=a(6009),n=a(1435),r=a(2875),u=a(9302),g=a(2620),c=a(2988),d=a(3529),b=function(e,t,a,l){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function i(e){try{r(l.next(e))}catch(t){s(t)}}function n(e){try{r(l["throw"](e))}catch(t){s(t)}}function r(e){e.done?a(e.value):o(e.value).then(i,n)}r((l=l.apply(e,t||[])).next())}))};const h={class:"col item-stretch"},m={key:0,class:"error"},v={class:"row text-center"},_={class:"col items-center",style:{width:"300px",height:"300px"}},S={class:"col text-center"},D={key:1},f={key:0,class:"decode-result"},p={key:1,class:"decode-result"},C={key:2,class:"decode-result"},w={key:3,class:"decode-result"},P={key:4},U={key:5},k="profile",y=(0,l.aZ)({__name:"BarCode",setup(e){const t=(0,s.iH)();function a(){d.b.getCurrentPosition({timeout:2e4}).then((e=>{B&&console.log("Current...",e),t.value=e}))}let y;function x(e,t,a,l){return O(e,t,a,l)}function q(e){return e*Math.PI/180}function O(e,t,a,l){var o=6371,s=q(a-e),i=q(l-t);e=q(e),a=q(a);var n=Math.sin(s/2)*Math.sin(s/2)+Math.sin(i/2)*Math.sin(i/2)*Math.cos(e)*Math.cos(a),r=2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n));return o*r}(0,l.bv)((()=>b(this,void 0,void 0,(function*(){a(),y=yield d.b.watchPosition({},((e,a)=>{B&&console.log("New GPS position",a),t.value=e}))})))),(0,l.Jd)((()=>{d.b.clearWatch({id:y})}));const N=(0,u.Z)(),E=new g.d(N),B=E.globalDebug||E.barCodePageDebug,V=(0,s.iH)(JSON.parse(N.localStorage.getItem(k)+""));null===V.value&&(V.value={volunteerNo:"",name:"",phoneNo:"",email:"",expanded:!1});const $=(0,s.iH)("off"),T=(0,s.iH)(),H=(0,s.iH)(),A=(0,s.iH)(),z=(0,s.iH)(),I=(0,s.iH)(),M=(0,s.iH)(),W=(0,s.iH)(),j=(0,s.iH)();function J(e){B&&console.log("onDetect",e);const a=e,[l]=a;let o;if(B&&console.log(l.rawValue),l.rawValue.startsWith("{")){const e=JSON.parse(l.rawValue);I.value=e.eventId,z.value=e.event,M.value=e.location,W.value=e.lat,j.value=e.lon,"object"===typeof t.value&&t.value&&(A.value=x(W.value,j.value,t.value.coords.latitude,t.value.coords.longitude)),o=JSON.stringify(e)}else o=l.rawValue;H.value=o,ee(),R.value=c.ou.now().toISO(),X()}function K(){N.notify({message:`${V.value.name} 签到成功!`,color:"green-6"}),H.value=void 0}function L(){H.value=void 0}let Y;const R=(0,s.iH)(),Z=(0,s.iH)(),G=(0,s.iH)();function Q(){clearTimeout(Y),Y=setTimeout((()=>{B&&console.log("cameraOffTimer"),X(),G.value=c.ou.now().toISO()}),1e4)}function F(){B&&console.log("onCameraHandler"),$.value="auto",Z.value=c.ou.now().toISO(),R.value="",G.value="",Q()}function X(){B&&console.log("offCameraHandler"),$.value="off"}function ee(){let e=new Audio("/censor-beep-01.mp3");e.play()}function te(e){B&&console.log("onErrorHandler",e),T.value=`[${e.name}]: `,"NotAllowedError"===e.name?T.value+="you need to grant camera access permission":"NotFoundError"===e.name?T.value+="no camera on this device":"NotSupportedError"===e.name?T.value+="secure context required (HTTPS, localhost)":"NotReadableError"===e.name?T.value+="is the camera already in use?":"OverconstrainedError"===e.name?T.value+="installed cameras are not suitable":"StreamApiNotSupportedError"===e.name?T.value+="Stream API is not supported in this browser":"InsecureContextError"===e.name?T.value+="Camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.":T.value+=e.message}return(e,a)=>{const u=(0,l.up)("q-chip"),g=(0,l.up)("q-input"),c=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(c,{class:"q-pa-sm"},{default:(0,l.w5)((()=>{var e,c,d,b;return[(0,l._)("div",h,[(0,l._)("div",{class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"","bg-red-2"))},[(0,l._)("div",{class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"text-h4 text-center","bg-yellow-6"))},(0,o.zw)(V.value.name),3),(0,l._)("div",{class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"text-center","bg-yellow-2"))},[(0,l.Wm)(n.Z,{value:V.value.volunteerNo,margin:0,width:1.5,height:100,format:"CODE39",lineColor:"black",elementTag:"canvas"},null,8,["value"])],2)],2),"auto"!==$.value?((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"text-center","bg-blue-2"))},[(0,l.Wm)(u,{clickable:"",color:"green","text-color":"white",size:"lg",onClick:F},{default:(0,l.w5)((()=>[(0,l.Uk)("自助签到")])),_:1}),(0,l.Wm)(u,{clickable:"",color:"green","text-color":"white",size:"lg",onClick:F},{default:(0,l.w5)((()=>[(0,l.Uk)("工作人员 自助签到")])),_:1})],2)):(0,l.kq)("",!0),"auto"===$.value?((0,l.wg)(),(0,l.iD)("div",{key:1,class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"text-center","bg-green-2"))},[T.value?((0,l.wg)(),(0,l.iD)("div",m,(0,o.zw)(T.value),1)):(0,l.kq)("",!0),(0,l._)("div",v,[(0,l._)("div",_,["auto"===$.value?((0,l.wg)(),(0,l.j4)((0,s.SU)(i.vG),{key:0,onDetect:J,onError:te,camera:$.value},null,8,["camera"])):(0,l.kq)("",!0)])])],2)):(0,l.kq)("",!0),H.value?((0,l.wg)(),(0,l.iD)("div",{key:2,class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"col","bg-purple-2"))},[(0,l._)("div",{class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"row q-col-gutter-sm","bg-yellow-2"))},[(0,l.Wm)(g,{modelValue:I.value,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value=e),label:"Event ID",readonly:"",class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"col-6","bg-blue-2"))},null,8,["modelValue","class"]),(0,l.Wm)(g,{modelValue:z.value,"onUpdate:modelValue":a[1]||(a[1]=e=>z.value=e),label:"Event",readonly:"",class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"col-6","bg-red-2"))},null,8,["modelValue","class"])],2),(0,l._)("div",{class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"q-col-gutter-sm","bg-yellow-2"))},[(0,l.Wm)(g,{modelValue:M.value,"onUpdate:modelValue":a[2]||(a[2]=e=>M.value=e),label:"Location",readonly:"",class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"","bg-blue-2"))},null,8,["modelValue","class"])],2),(0,l._)("div",{class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"row q-col-gutter-sm","bg-yellow-2"))},[(0,l.Wm)(g,{modelValue:W.value,"onUpdate:modelValue":a[3]||(a[3]=e=>W.value=e),label:"Latitude",readonly:"",class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"col-6","bg-blue-2"))},null,8,["modelValue","class"]),(0,l.Wm)(g,{modelValue:j.value,"onUpdate:modelValue":a[4]||(a[4]=e=>j.value=e),label:"Longitude",readonly:"",class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"col-6","bg-red-2"))},null,8,["modelValue","class"])],2),"object"===typeof t.value&&t.value?((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"q-col-gutter-sm","bg-yellow-2"))},[(0,l.Wm)(g,{modelValue:A.value,"onUpdate:modelValue":a[5]||(a[5]=e=>A.value=e),label:"Distance",readonly:"",class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"","bg-blue-2"))},null,8,["modelValue","class"])],2)):(0,l.kq)("",!0),(0,l._)("div",null,[(0,l._)("div",S,[(0,l.Wm)(u,{clickable:"",color:"green","text-color":"white",size:"lg",onClick:K},{default:(0,l.w5)((()=>[(0,l.Uk)("确认")])),_:1}),(0,l.Wm)(u,{clickable:"",color:"red","text-color":"white",size:"lg",onClick:L},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1})])]),(0,s.SU)(B)?((0,l.wg)(),(0,l.iD)("pre",D,(0,o.zw)(H.value),1)):(0,l.kq)("",!0)],2)):(0,l.kq)("",!0),(0,s.SU)(B)?((0,l.wg)(),(0,l.iD)("div",{key:3,class:(0,o.C_)((0,s.SU)(r.$)((0,s.SU)(B),"","bg-yellow-2"))},[(0,s.SU)(B)?((0,l.wg)(),(0,l.iD)("p",f,[(0,l.Uk)(" Last result: "),(0,l._)("b",null,(0,o.zw)(H.value),1)])):(0,l.kq)("",!0),(0,s.SU)(B)?((0,l.wg)(),(0,l.iD)("p",p,[(0,l.Uk)(" Camera On: "),(0,l._)("b",null,(0,o.zw)(Z.value),1)])):(0,l.kq)("",!0),(0,s.SU)(B)?((0,l.wg)(),(0,l.iD)("p",C,[(0,l.Uk)(" Last Scan: "),(0,l._)("b",null,(0,o.zw)(R.value),1)])):(0,l.kq)("",!0),(0,s.SU)(B)?((0,l.wg)(),(0,l.iD)("p",w,[(0,l.Uk)(" Camera Off: "),(0,l._)("b",null,(0,o.zw)(G.value),1)])):(0,l.kq)("",!0),"object"===typeof t.value?((0,l.wg)(),(0,l.iD)("div",P,[(0,l.Uk)(" GPS Latitude: "),(0,l._)("strong",null,(0,o.zw)(null===(c=null===(e=t.value)||void 0===e?void 0:e.coords)||void 0===c?void 0:c.latitude),1)])):(0,l.kq)("",!0),"object"===typeof t.value?((0,l.wg)(),(0,l.iD)("div",U,[(0,l.Uk)(" GPS Longitude: "),(0,l._)("strong",null,(0,o.zw)(null===(b=null===(d=t.value)||void 0===d?void 0:d.coords)||void 0===b?void 0:b.longitude),1)])):(0,l.kq)("",!0)],2)):(0,l.kq)("",!0)])]})),_:1})}}});var x=a(9885),q=a(7691),O=a(7471),N=a(9984),E=a.n(N);const B=y,V=B;E()(y,"components",{QPage:x.Z,QChip:q.Z,QInput:O.Z})}}]);