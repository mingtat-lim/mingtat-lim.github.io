"use strict";(globalThis["webpackChunkquasar_barcode"]=globalThis["webpackChunkquasar_barcode"]||[]).push([[338],{1338:(e,l,a)=>{a.r(l),a.d(l,{default:()=>z});var o=a(1347),t=a(7763),s=a(4187),n=a(455),i=a(8677),r=a(5887),d=a(6067),u=a(3022),c=a(2291),b=a(7047),m=a(6305),p=a(1458);const v={key:0},_={class:"row"},g={class:"row items-center"},k={class:"row items-center"},y={class:"row items-center"},h=(0,o.pM)({__name:"codeEditComponent",setup(e){const l=(0,b.C)(),{settings:a}=(0,m.bP)(l),{t:h}=(0,c.s9)(),f=(0,u.A)(),V=(0,n.rd)(),R=(0,n.lq)(),E=(0,r.n)(),C=a.value.barcodePageDebug;let q=!1;const L=(0,s.KR)(),w=(0,s.KR)(),F=R.query.id?parseInt(R.query.id.toString(),10):-1;let x={caption:"",barcode:"",expended:!1};-1===F?q=!0:x={...E.barcodes[F]};const A=[{label:h("region_east"),value:"东"},{label:h("region_central"),value:"中"},{label:h("region_north"),value:"北"},{label:h("region_south"),value:"南"}],U=[{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"}],S=[{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"}],z=[{label:h("volunteer_status_greyUniform"),value:"灰衣"},{label:h("volunteer_status_traineeCommissioners"),value:"见习委员"},{label:h("volunteer_status_traineeFaithCorp"),value:"见习慈诚"},{label:h("volunteer_status_attachmentCommissioners"),value:"培训委员"},{label:h("volunteer_status_attachmentFaithCorp"),value:"培训慈诚"},{label:h("volunteer_status_certifiedCommissioners"),value:"委员"},{label:h("volunteer_status_certifiedFaithCorp"),value:"慈诚"}],Q=(0,s.KR)(x);let B=JSON.stringify(Q.value);const O=()=>{if(C&&console.log("onSaveButtonClick"),B===JSON.stringify(Q.value))f.notify({type:"warning",position:"center",message:h("barcodeEdit_save_warning_message")});else{if(L.value?.validate(),w.value?.validate(),Q.value.barcode=(Q.value.barcode.trim()??"").toUpperCase()||"",Q.value.phone=Q.value.phone?.trim()??"",L.value?.hasError||w.value?.hasError)return void f.notify({type:"warning",position:"center",message:h("barcodeEdit_validation")});q?E.add(Q.value):E.update(Q.value,F),f.notify({type:"positive",position:"center",message:h("barcodeEdit_notify_RecordUpdated")}),B=JSON.stringify(Q.value),V.push("/barcode")}},W=()=>{C&&console.log("onDeleteButtonClick"),f.dialog({title:h("barcodeEdit_comfirmation_title"),message:h("barcodeEdit_delete_confirmation"),cancel:{label:h("button_caption_cancel"),push:!0},ok:{label:h("button_caption_delete")},persistent:!0}).onOk((()=>{E.delete(F),f.notify({type:"positive",position:"center",message:h("barcodeEdit_notify_RecordDeleted")}),V.push("/barcode")})).onCancel((()=>{})).onDismiss((()=>{}))},P=()=>{C&&console.log("onCloseButtonClick"),V.push("/barcode")};function D(){return new Promise(((e,l)=>{f.dialog({title:h("barcodeEdit_comfirmation_title"),message:h("barcodeEdit_unsave_warning_message"),cancel:{label:h("button_caption_cancel")},ok:{label:h("button_caption_yes")}}).onOk((()=>{e(!0)})).onCancel((()=>{l()})).onDismiss((()=>{}))}))}(0,n.JZ)(((e,l,a)=>{B!==JSON.stringify(Q.value)?D().then((()=>a())).catch((()=>!1)):a()}));const K=(0,s.KR)(null),N=(0,s.KR)(80);function X(){K.value&&(N.value=K.value.offsetHeight)}function G(e){if(""===e.trim())return!0;if(!e||"string"!==typeof e||""===e.trim())return h("barcodeEdit_phone_validate_message");const l=p.p.cleanPhoneNumber(e),a=p.p.validateMobileNumber(l);return!!a.isValid||("SG"===a.country?h("barcodeEdit_phone_validate_sg"):"MY"===a.country?h("barcodeEdit_phone_validate_my"):h("barcodeEdit_phone_validate_message"))}function I(e){if(!e||"string"!==typeof e||""===e.trim())return h("barcodeEdit_barcode_validate_message");const l=e.trim();return 8!==l.length?h("barcodeEdit_barcode_length_message")||"Barcode must be 8 characters.":!!/^SG\d{6}$/i.test(l)||(h("barcodeEdit_barcode_format_message")||"Barcode must start with SG and followed by 6 digits.")}return(0,o.sV)((()=>{(0,o.dY)((()=>{X(),window.addEventListener("resize",X)}))})),(0,o.xo)((()=>{window.removeEventListener("resize",X)})),(e,l)=>{const n=(0,o.g2)("q-btn"),r=(0,o.g2)("q-select"),u=(0,o.g2)("q-option-group"),c=(0,o.g2)("q-field");return(0,o.uX)(),(0,o.CE)(o.FK,null,[l[19]||(l[19]=(0,o.Lk)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"},null,-1)),(0,o.Lk)("div",{class:"row q-pa-xs sticky-header",style:{top:"50px"},ref_key:"headerRef",ref:K},[(0,o.Lk)("div",{class:(0,t.C4)((0,s.R1)(i.y)((0,s.R1)(C),"col-md-auto q-pa-sm x-v-align-middle","bg-red-3"))},[(0,s.R1)(q)?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(n,{key:0,color:"red",icon:"delete",round:"",onClick:W,class:"q-mr-xs"}))],2),(0,o.Lk)("div",{class:(0,t.C4)((0,s.R1)(i.y)((0,s.R1)(C),"col text-h3 text-center text-capitalize","bg-blue-3"))},(0,t.v_)((0,s.R1)(q)?(0,s.R1)(h)("barcodeEdit_add"):(0,s.R1)(h)("barcodeEdit_update")),3),(0,o.Lk)("div",{class:(0,t.C4)((0,s.R1)(i.y)((0,s.R1)(C),"col-md-auto q-pa-sm x-v-align-middle","bg-red-3"))},[(0,o.bF)(n,{color:"green",icon:"close",round:"",onClick:P,class:"q-mr-md"}),(0,s.R1)(q)?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(n,{key:0,color:"green",icon:"save_as",round:"",onClick:O,class:"q-mr-xs"})),(0,s.R1)(q)?((0,o.uX)(),(0,o.Wv)(n,{key:1,color:"green",icon:"save",round:"",onClick:O,class:"q-mr-xs"})):(0,o.Q3)("",!0)],2)],512),(0,o.Lk)("div",{class:"q-pa-md",style:(0,t.Tr)({marginTop:N.value+"px"})},[(0,o.bF)((0,s.R1)(d.A),{outlined:"","bottom-slots":"",clearable:"",modelValue:Q.value.caption,"onUpdate:modelValue":l[0]||(l[0]=e=>Q.value.caption=e),ref_key:"captionControl",ref:L,rules:[e=>!!e||(0,s.R1)(h)("barcodeEdit_item_validate_message")],label:(0,s.R1)(h)("barcodeEdit_item")},{prepend:(0,o.k6)((()=>[...l[13]||(l[13]=[(0,o.Lk)("span",{class:"material-symbols-outlined"}," id_card ",-1)])])),_:1},8,["modelValue","rules","label"]),(0,o.bF)((0,s.R1)(d.A),{outlined:"","bottom-slots":"",clearable:"",modelValue:Q.value.name,"onUpdate:modelValue":l[1]||(l[1]=e=>Q.value.name=e),label:(0,s.R1)(h)("barcodeEdit_english_name")},{prepend:(0,o.k6)((()=>[...l[14]||(l[14]=[(0,o.Lk)("span",{class:"material-symbols-outlined"}," language_gb_english ",-1)])])),_:1},8,["modelValue","label"]),(0,o.bF)((0,s.R1)(d.A),{outlined:"","bottom-slots":"",clearable:"",modelValue:Q.value.barcode,"onUpdate:modelValue":l[2]||(l[2]=e=>Q.value.barcode=e),ref_key:"captionBarcode",ref:w,rules:[I],label:(0,s.R1)(h)("barcodeEdit_barcode")},{prepend:(0,o.k6)((()=>[...l[15]||(l[15]=[(0,o.Lk)("span",{class:"material-symbols-outlined"}," barcode ",-1)])])),_:1},8,["modelValue","rules","label"]),(0,o.bF)((0,s.R1)(d.A),{outlined:"","bottom-slots":"",clearable:"",modelValue:Q.value.phone,"onUpdate:modelValue":l[3]||(l[3]=e=>Q.value.phone=e),rules:[G],label:(0,s.R1)(h)("barcodeEdit_phone")},{prepend:(0,o.k6)((()=>[...l[16]||(l[16]=[(0,o.Lk)("span",{class:"material-symbols-outlined"}," phone ",-1)])])),_:1},8,["modelValue","rules","label"]),(0,s.R1)(a).systemAdmin?((0,o.uX)(),(0,o.CE)("div",v,[(0,o.bF)(r,{outlined:"","bottom-slots":"",clearable:"","emit-value":"","map-options":"","label-slot":"",modelValue:Q.value.status,"onUpdate:modelValue":l[4]||(l[4]=e=>Q.value.status=e),options:z},{label:(0,o.k6)((()=>[(0,o.eW)((0,t.v_)((0,s.R1)(h)("barcodeEdit_volunteer_status")),1)])),_:1},8,["modelValue"]),(0,o.Lk)("div",_,[(0,o.bF)(c,{class:"col",outlined:"","bottom-slots":"",clearable:"","label-slot":"","stack-label":"",modelValue:Q.value.region,"onUpdate:modelValue":l[6]||(l[6]=e=>Q.value.region=e)},{label:(0,o.k6)((()=>[(0,o.eW)((0,t.v_)((0,s.R1)(h)("barcodeEdit_volunteer_region")),1)])),control:(0,o.k6)((()=>[(0,o.bF)(u,{inline:"",color:"primary",type:"radio",class:"q-mt-xs",options:A,modelValue:Q.value.region,"onUpdate:modelValue":l[5]||(l[5]=e=>Q.value.region=e)},{label:(0,o.k6)((e=>[(0,o.Lk)("div",g,[(0,o.Lk)("span",null,(0,t.v_)(e.label),1)])])),_:1},8,["modelValue"])])),_:1},8,["modelValue"]),(0,o.bF)(c,{class:"col q-ml-xs q-mr-xs",outlined:"","bottom-slots":"",clearable:"","label-slot":"","stack-label":"",modelValue:Q.value.zone,"onUpdate:modelValue":l[8]||(l[8]=e=>Q.value.zone=e)},{label:(0,o.k6)((()=>[(0,o.eW)((0,t.v_)((0,s.R1)(h)("barcodeEdit_volunteer_zone")),1)])),control:(0,o.k6)((()=>[(0,o.bF)(u,{inline:"",color:"primary",type:"radio",class:"q-mt-xs",options:U,modelValue:Q.value.zone,"onUpdate:modelValue":l[7]||(l[7]=e=>Q.value.zone=e)},{label:(0,o.k6)((e=>[(0,o.Lk)("div",k,[(0,o.Lk)("span",null,(0,t.v_)(e.label),1)])])),_:1},8,["modelValue"])])),_:1},8,["modelValue"]),(0,o.bF)(c,{class:"col",outlined:"","bottom-slots":"",clearable:"","label-slot":"","stack-label":"",modelValue:Q.value.team,"onUpdate:modelValue":l[10]||(l[10]=e=>Q.value.team=e)},{label:(0,o.k6)((()=>[(0,o.eW)((0,t.v_)((0,s.R1)(h)("barcodeEdit_volunteer_team")),1)])),control:(0,o.k6)((()=>[(0,o.bF)(u,{inline:"",color:"primary",type:"radio",class:"q-mt-xs",options:S,modelValue:Q.value.team,"onUpdate:modelValue":l[9]||(l[9]=e=>Q.value.team=e)},{label:(0,o.k6)((e=>[(0,o.Lk)("div",y,[(0,o.Lk)("span",null,(0,t.v_)(e.label),1)])])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])]),(0,o.bF)(r,{outlined:"","bottom-slots":"",clearable:"","emit-value":"","map-options":"",dense:"","label-slot":"","use-input":"","use-chips":"",multiple:"","hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add-unique",modelValue:Q.value.tags,"onUpdate:modelValue":l[11]||(l[11]=e=>Q.value.tags=e),label:(0,s.R1)(h)("barcodeEdit_tags"),hint:(0,s.R1)(h)("barcodeEdit_tag_hint"),"hide-hint":""},{prepend:(0,o.k6)((()=>[...l[17]||(l[17]=[(0,o.Lk)("span",{class:"material-symbols-outlined"}," tag ",-1)])])),_:1},8,["modelValue","label","hint"]),(0,o.bF)((0,s.R1)(d.A),{"lazy-rules":"",outlined:"","bottom-slots":"",dense:"",clearable:"",modelValue:Q.value.notes,"onUpdate:modelValue":l[12]||(l[12]=e=>Q.value.notes=e),label:(0,s.R1)(h)("barcodeEdit_notes"),type:"textarea"},{prepend:(0,o.k6)((()=>[...l[18]||(l[18]=[(0,o.Lk)("span",{class:"material-symbols-outlined"}," notes ",-1)])])),_:1},8,["modelValue","label"])])):(0,o.Q3)("",!0)],4)],64)}}});var f=a(2968),V=a(9039),R=a(6839),E=a(7861),C=a(4552),q=a(272),L=a.n(q);const w=(0,f.A)(h,[["__scopeId","data-v-6432bc93"]]),F=w;L()(h,"components",{QBtn:V.A,QInput:d.A,QSelect:R.A,QField:E.A,QOptionGroup:C.A});const x={class:"item"},A=(0,o.pM)({name:"BarcodePage",__name:"barcodeEditPage",setup(e){return(e,l)=>{const a=(0,o.g2)("q-page");return(0,o.uX)(),(0,o.Wv)(a,{class:"row content-container"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",x,[(0,o.bF)(F)])])),_:1})}}});var U=a(5013);const S=(0,f.A)(A,[["__scopeId","data-v-5a5385d4"]]),z=S;L()(A,"components",{QPage:U.A})}}]);