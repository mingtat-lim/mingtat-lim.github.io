"use strict";(globalThis["webpackChunkqr_generator"]=globalThis["webpackChunkqr_generator"]||[]).push([[773],{2875:(e,t,s)=>{function l(e,t,s){return e?`${t} ${s}`:t}function a(e,t,s,l){return e%2===0?`${t} ${s}`:`${t} ${l}`}s.d(t,{$:()=>l,r:()=>a})},2620:(e,t,s)=>{s.d(t,{HG:()=>i,IK:()=>o,Px:()=>a,de:()=>l,xB:()=>n});class l{constructor(e){this._settings={isAdmin:!1,globalDebug:!1,homePageDebug:!1,barCodePageDebug:!1,qrCodePageDebug:!1,profilePageDebug:!1,memberPageDebug:!1,eventsPageDebug:!1,scanCodePageDebug:!1,geolocationPageDebug:!1,settingsPageDebug:!1},this.DB_KEY="SETTINGS",this._local=e.localStorage,null===this._local.getItem(this.DB_KEY)&&this._local.set(this.DB_KEY,JSON.stringify(this.getState()));const t=JSON.parse(this._local.getItem(this.DB_KEY)+"");this._settings=Object.assign(Object.assign({},this._settings),t)}saveSettings(){this._local.set(this.DB_KEY,JSON.stringify(this.getState()))}getState(){return this._settings}get isAdmin(){return this._settings.isAdmin}set isAdmin(e){this._settings.isAdmin=e}get globalDebug(){return this._settings.globalDebug}set globalDebug(e){this._settings.globalDebug=e}get eventsPageDebug(){return this._settings.eventsPageDebug}set eventsPageDebug(e){this._settings.eventsPageDebug=e}get barCodePageDebug(){return this._settings.barCodePageDebug}set barCodePageDebug(e){this._settings.barCodePageDebug=e}get geolocationPageDebug(){return this._settings.geolocationPageDebug}set geolocationPageDebug(e){this._settings.geolocationPageDebug=e}get homePageDebug(){return this._settings.homePageDebug}set homePageDebug(e){this._settings.homePageDebug=e}get memberPageDebug(){return this._settings.memberPageDebug}set memberPageDebug(e){this._settings.memberPageDebug=e}get profilePageDebug(){return this._settings.profilePageDebug}set profilePageDebug(e){this._settings.profilePageDebug=e}get qrCodePageDebug(){return this._settings.qrCodePageDebug}set qrCodePageDebug(e){this._settings.qrCodePageDebug=e}get scanCodePageDebug(){return this._settings.scanCodePageDebug}set scanCodePageDebug(e){this._settings.scanCodePageDebug=e}get settingsPageDebug(){return this._settings.settingsPageDebug}set settingsPageDebug(e){this._settings.settingsPageDebug=e}}class a{constructor(e){this.KEY_BARCODE_DB="barcode-db",this._state={title:"条形码数据库",barCodes:[]},this._local=e.localStorage,null===this._local.getItem(this.KEY_BARCODE_DB)&&this._local.set(this.KEY_BARCODE_DB,JSON.stringify(this.getState()));const t=JSON.parse(this._local.getItem(this.KEY_BARCODE_DB)+"");this._state=Object.assign(Object.assign({},this._state),t)}getState(){return this._state}saveData(){this._local.set(this.KEY_BARCODE_DB,JSON.stringify(this.getState()))}get newItem(){return{caption:"",barCode:"",expanded:!1}}addBarCode(e){this._state.barCodes.push(e)}deleteBarCode(e){this._state.barCodes=[...this._state.barCodes.slice(0,e),...this._state.barCodes.slice(e+1)]}get title(){return this._state.title}get barCodes(){return this._state.barCodes}}class o{constructor(){this.functionList=[]}addFunctionGroup(){const e={groupName:"",slots:[{slot:"",selected:!1},{slot:"",selected:!1},{slot:"",selected:!1}]};return this.functionList.push(e),e}}class i{constructor(){this.title="功能组",this.checkinOptions=[]}addFunctionGroup(){const e={groupName:"",slots:[{slot:"",selected:!1},{slot:"",selected:!1},{slot:"",selected:!1}]};return this.checkinOptions.push(e),e}}class n{constructor(e){this.KEY_BARCODE_DB="events",this._state={events:[]},this._local=e.localStorage,null===this._local.getItem(this.KEY_BARCODE_DB)&&this._local.set(this.KEY_BARCODE_DB,JSON.stringify(this.getState()));const t=JSON.parse(this._local.getItem(this.KEY_BARCODE_DB)+"");console.log("config",t),this._state.events=t,console.log("_state",this._state)}getState(){return this._state}get stateString(){return JSON.stringify(this.getState())}restoreData(e){const t=JSON.parse(e);this._state=t}resetData(){this._state.events=[]}saveData(){this._local.set(this.KEY_BARCODE_DB,this.stateString)}get newItem(){return{eventId:"",event:"",eventDate:"",startTime:"",endTime:"",location:"",lat:-1,lon:-1,signupOptions:void 0,checkinOptions:void 0,isSignup:!1,isRegister:!1,expanded:!1}}addBarCode(e){this._state.events.push(e)}deleteBarCode(e){this._state.events=[...this._state.events.slice(0,e),...this._state.events.slice(e+1)]}get events(){return this._state.events}getItemById(e){return this.events.find((t=>t.eventId===e))}}},1435:(e,t,s)=>{s.d(t,{Z:()=>u});var l=s(9835),a=s(1265);const o={name:"BarcodeGenerator",props:{value:[String,Number],format:[String],width:[String,Number],height:[String,Number],displayValue:{type:[String,Boolean],default:!0},text:[String,Number],fontOptions:[String],font:[String],textAlign:[String],textPosition:[String],textMargin:[String,Number],fontSize:[String,Number],background:[String],lineColor:[String],margin:[String,Number],marginTop:[String,Number],marginBottom:[String,Number],marginLeft:[String,Number],marginRight:[String,Number],flat:[Boolean],ean128:[String,Boolean],elementTag:{type:String,default:"svg",validator:function(e){return-1!==["canvas","svg","img"].indexOf(e)}}},render(){return(0,l.h)(this.elementTag,{id:["barcodegen"]})},mounted:function(){i.call(this)}};function i(){this.value;var e={format:this.format,width:this.width,height:this.height,displayValue:this.displayValue,text:this.text,fontOptions:this.fontOptions,font:this.font,textAlign:this.textAlign,textPosition:this.textPosition,textMargin:this.textMargin,fontSize:this.fontSize,background:this.background,lineColor:this.lineColor,margin:this.margin,marginTop:this.marginTop,marginBottom:this.marginBottom,marginLeft:this.marginLeft,marginRight:this.marginRight,flat:this.flat,ean128:this.ean128,valid:function(e){e},elementTag:this.elementTag};n(e),a(this.$el,this.value,e)}function n(e){Object.keys(e).forEach((t=>void 0===e[t]?delete e[t]:{}))}const r=o,u=r},8244:(e,t,s)=>{s.d(t,{Z:()=>b});var l=s(9835),a=s(6970),o=s(499),i=s(2875);const n={class:"col-2"},r={class:"col-2"},u={key:0,class:"col-2"},g=(0,l.aZ)({__name:"FunctionSlot",props:{debug:{type:Boolean,default:!1},index:{},group:{}},setup(e){const t=e,s=(0,o.iH)(t.group);return(e,g)=>{const c=(0,l.up)("q-checkbox");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",{class:(0,a.C_)((0,o.SU)(i.r)(t.index,"row items-center","bg-blue-2","bg-green-2"))},[(0,l._)("div",{class:(0,a.C_)((0,o.SU)(i.$)(e.debug,"col-6","bg-green-2"))},(0,a.zw)(s.value.groupName),3),(0,l._)("div",n,[(0,l._)("div",{class:(0,a.C_)((0,o.SU)(i.$)(e.debug,"row items-center","bg-yellow-2"))},[(0,l._)("div",null,[(0,l.Wm)(c,{modelValue:s.value.slots[0].selected,"onUpdate:modelValue":g[0]||(g[0]=e=>s.value.slots[0].selected=e)},null,8,["modelValue"])]),(0,l._)("div",{class:(0,a.C_)((0,o.SU)(i.$)(e.debug,"","bg-green-2"))},(0,a.zw)(s.value.slots[0].slot),3)],2)]),(0,l._)("div",r,[(0,l._)("div",{class:(0,a.C_)((0,o.SU)(i.$)(e.debug,"row items-center","bg-blue-2"))},[(0,l._)("div",null,[(0,l.Wm)(c,{modelValue:s.value.slots[1].selected,"onUpdate:modelValue":g[1]||(g[1]=e=>s.value.slots[1].selected=e)},null,8,["modelValue"])]),(0,l._)("div",null,(0,a.zw)(s.value.slots[1].slot),1)],2)]),""!==s.value.slots[2].slot?((0,l.wg)(),(0,l.iD)("div",u,[(0,l._)("div",{class:(0,a.C_)((0,o.SU)(i.$)(e.debug,"row items-center","bg-yellow-2"))},[(0,l._)("div",null,[(0,l.Wm)(c,{modelValue:s.value.slots[2].selected,"onUpdate:modelValue":g[2]||(g[2]=e=>s.value.slots[2].selected=e)},null,8,["modelValue"])]),(0,l._)("div",null,(0,a.zw)(s.value.slots[1].slot),1)],2)])):(0,l.kq)("",!0)],2),(e.debug,(0,l.kq)("",!0))],64)}}});var c=s(1221),d=s(9984),h=s.n(d);const v=g,b=v;h()(g,"components",{QCheckbox:c.Z})},5773:(e,t,s)=>{s.r(t),s.d(t,{default:()=>H});var l=s(9835),a=s(6970),o=s(499),i=s(8244),n=s(6009),r=s(1435),u=s(2875),g=s(9302),c=s(2620),d=s(2988),h=s(3529),v=function(e,t,s,l){function a(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,o){function i(e){try{r(l.next(e))}catch(t){o(t)}}function n(e){try{r(l["throw"](e))}catch(t){o(t)}}function r(e){e.done?s(e.value):a(e.value).then(i,n)}r((l=l.apply(e,t||[])).next())}))};const b={class:"col item-stretch"},m={key:0,class:"error"},_={class:"row text-center"},S={class:"col items-center",style:{width:"300px",height:"300px"}},p={key:1},D={key:0},f={class:"col text-center"},w={key:2},C={key:0,class:"decode-result"},U={key:1,class:"decode-result"},k={key:2,class:"decode-result"},y={key:3,class:"decode-result"},P={key:4},O={key:5},x="profile",B=(0,l.aZ)({__name:"BarCode",setup(e){const t=(0,o.iH)();function s(){h.b.getCurrentPosition({timeout:2e4}).then((e=>{H&&console.log("Current...",e),t.value=e}))}let B;function E(e,t,s,l){return q(e,t,s,l)}function N(e){return e*Math.PI/180}function q(e,t,s,l){var a=6371,o=N(s-e),i=N(l-t);e=N(e),s=N(s);var n=Math.sin(o/2)*Math.sin(o/2)+Math.sin(i/2)*Math.sin(i/2)*Math.cos(e)*Math.cos(s),r=2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n));return a*r}(0,l.bv)((()=>v(this,void 0,void 0,(function*(){s(),B=yield h.b.watchPosition({},((e,s)=>{H&&console.log("New GPS position",s),t.value=e}))})))),(0,l.Jd)((()=>{h.b.clearWatch({id:B})}));const V=(0,g.Z)(),$=new c.de(V),I=(0,o.iH)(new c.xB(V)),H=$.globalDebug||$.barCodePageDebug,T=(0,o.iH)(JSON.parse(V.localStorage.getItem(x)+""));null===T.value&&(T.value={volunteerNo:"",name:"",phoneNo:"",email:"",expanded:!1});const A=(0,o.iH)("off"),z=(0,o.iH)(),K=(0,o.iH)(),Y=(0,o.iH)(),W=(0,o.iH)(),J=(0,o.iH)(),R=(0,o.iH)(),M=(0,o.iH)(),j=(0,o.iH)();let L,Z;function G(e){H&&console.log("onDetect",e);const s=e,[l]=s;let a;if(H&&console.log(l.rawValue),l.rawValue.startsWith("{")){const e=JSON.parse(l.rawValue);J.value=e.eventId,W.value=e.event,R.value=e.location,M.value=e.lat,j.value=e.lon,"object"===typeof t.value&&t.value&&(Y.value=E(M.value,j.value,t.value.coords.latitude,t.value.coords.longitude)),L=I.value.getItemById(e.eventId),a=JSON.stringify(e)}else a=l.rawValue;K.value=a,ie(),X.value=d.ou.now().toISO(),oe()}function F(){V.notify({message:`${T.value.name} 签到成功!`,color:"green-6"}),K.value=void 0}function Q(){K.value=void 0}const X=(0,o.iH)(),ee=(0,o.iH)(),te=(0,o.iH)();function se(){clearTimeout(Z),Z=setTimeout((()=>{H&&console.log("cameraOffTimer"),oe(),te.value=d.ou.now().toISO()}),1e4)}let le=(0,o.iH)(!1);function ae(e=!1){H&&console.log("onCameraHandler"),le.value=e,A.value="auto",ee.value=d.ou.now().toISO(),X.value="",te.value="",se()}function oe(){H&&console.log("offCameraHandler"),A.value="off"}function ie(){let e=new Audio("/censor-beep-01.mp3");e.play()}function ne(e){H&&console.log("onErrorHandler",e),z.value=`[${e.name}]: `,"NotAllowedError"===e.name?z.value+="you need to grant camera access permission":"NotFoundError"===e.name?z.value+="no camera on this device":"NotSupportedError"===e.name?z.value+="secure context required (HTTPS, localhost)":"NotReadableError"===e.name?z.value+="is the camera already in use?":"OverconstrainedError"===e.name?z.value+="installed cameras are not suitable":"StreamApiNotSupportedError"===e.name?z.value+="Stream API is not supported in this browser":"InsecureContextError"===e.name?z.value+="Camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.":z.value+=e.message}return(e,s)=>{const g=(0,l.up)("q-chip"),c=(0,l.up)("q-input"),d=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(d,{class:"q-pa-sm"},{default:(0,l.w5)((()=>{var e,d,h,v,x,B;return[(0,l._)("div",b,[(0,l._)("div",{class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"","bg-red-2"))},[(0,l._)("div",{class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"text-h4 text-center","bg-yellow-6"))},(0,a.zw)(T.value.name),3),(0,l._)("div",{class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"text-center","bg-yellow-2"))},[(0,l.Wm)(r.Z,{value:T.value.volunteerNo,margin:0,width:1.5,height:100,format:"CODE39",lineColor:"black",elementTag:"canvas"},null,8,["value"])],2)],2),"auto"!==A.value?((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"text-center","bg-blue-2"))},[(0,l.Wm)(g,{clickable:"",color:"green","text-color":"white",size:"lg",onClick:s[0]||(s[0]=e=>ae())},{default:(0,l.w5)((()=>[(0,l.Uk)("自助签到")])),_:1}),(0,l.Wm)(g,{clickable:"",color:"green","text-color":"white",size:"lg",onClick:s[1]||(s[1]=e=>ae(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("工作人员 自助签到")])),_:1})],2)):(0,l.kq)("",!0),"auto"===A.value?((0,l.wg)(),(0,l.iD)("div",{key:1,class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"text-center","bg-green-2"))},[z.value?((0,l.wg)(),(0,l.iD)("div",m,(0,a.zw)(z.value),1)):(0,l.kq)("",!0),(0,l._)("div",_,[(0,l._)("div",S,["auto"===A.value?((0,l.wg)(),(0,l.j4)((0,o.SU)(n.vG),{key:0,onDetect:G,onError:ne,camera:A.value},null,8,["camera"])):(0,l.kq)("",!0)])])],2)):(0,l.kq)("",!0),K.value?((0,l.wg)(),(0,l.iD)("div",{key:2,class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"col","bg-purple-2"))},[(0,l._)("div",{class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"row q-col-gutter-sm","bg-yellow-2"))},[(0,l.Wm)(c,{modelValue:J.value,"onUpdate:modelValue":s[2]||(s[2]=e=>J.value=e),label:"Event ID",readonly:"",class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"col-6","bg-blue-2"))},null,8,["modelValue","class"]),(0,l.Wm)(c,{modelValue:W.value,"onUpdate:modelValue":s[3]||(s[3]=e=>W.value=e),label:"Event",readonly:"",class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"col-6","bg-red-2"))},null,8,["modelValue","class"])],2),(0,l._)("div",{class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"q-col-gutter-sm","bg-yellow-2"))},[(0,l.Wm)(c,{modelValue:R.value,"onUpdate:modelValue":s[4]||(s[4]=e=>R.value=e),label:"Location",readonly:"",class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"","bg-blue-2"))},null,8,["modelValue","class"])],2),(0,l._)("div",{class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"row q-col-gutter-sm","bg-yellow-2"))},[(0,l.Wm)(c,{modelValue:M.value,"onUpdate:modelValue":s[5]||(s[5]=e=>M.value=e),label:"Latitude",readonly:"",class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"col-6","bg-blue-2"))},null,8,["modelValue","class"]),(0,l.Wm)(c,{modelValue:j.value,"onUpdate:modelValue":s[6]||(s[6]=e=>j.value=e),label:"Longitude",readonly:"",class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"col-6","bg-red-2"))},null,8,["modelValue","class"])],2),"object"===typeof t.value&&t.value?((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"q-col-gutter-sm","bg-yellow-2"))},[(0,l.Wm)(c,{modelValue:Y.value,"onUpdate:modelValue":s[7]||(s[7]=e=>Y.value=e),label:"Distance",readonly:"",class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"","bg-blue-2"))},null,8,["modelValue","class"])],2)):(0,l.kq)("",!0),(0,o.SU)(le)&&(0,o.SU)(L)?((0,l.wg)(),(0,l.iD)("div",p,[(0,l._)("div",{class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"","bg-red-2"))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(null===(e=(0,o.SU)(L).checkinOptions)||void 0===e?void 0:e.checkinOptions,((e,t)=>((0,l.wg)(),(0,l.j4)(i.Z,{key:t,index:t,debug:(0,o.SU)(H),group:e},null,8,["index","debug","group"])))),128))],2),(0,o.SU)(H)?((0,l.wg)(),(0,l.iD)("div",D,[(0,l._)("pre",null,(0,a.zw)(JSON.stringify(null===(d=(0,o.SU)(L).checkinOptions)||void 0===d?void 0:d.checkinOptions,null,4)),1)])):(0,l.kq)("",!0)])):(0,l.kq)("",!0),(0,l._)("div",null,[(0,l._)("div",f,[(0,l.Wm)(g,{clickable:"",color:"green","text-color":"white",size:"lg",onClick:F},{default:(0,l.w5)((()=>[(0,l.Uk)("确认")])),_:1}),(0,l.Wm)(g,{clickable:"",color:"red","text-color":"white",size:"lg",onClick:Q},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1})])]),(0,o.SU)(H)?((0,l.wg)(),(0,l.iD)("pre",w,(0,a.zw)(K.value),1)):(0,l.kq)("",!0)],2)):(0,l.kq)("",!0),(0,o.SU)(H)?((0,l.wg)(),(0,l.iD)("div",{key:3,class:(0,a.C_)((0,o.SU)(u.$)((0,o.SU)(H),"","bg-yellow-2"))},[(0,o.SU)(H)?((0,l.wg)(),(0,l.iD)("p",C,[(0,l.Uk)(" Last result: "),(0,l._)("b",null,(0,a.zw)(K.value),1)])):(0,l.kq)("",!0),(0,o.SU)(H)?((0,l.wg)(),(0,l.iD)("p",U,[(0,l.Uk)(" Camera On: "),(0,l._)("b",null,(0,a.zw)(ee.value),1)])):(0,l.kq)("",!0),(0,o.SU)(H)?((0,l.wg)(),(0,l.iD)("p",k,[(0,l.Uk)(" Last Scan: "),(0,l._)("b",null,(0,a.zw)(X.value),1)])):(0,l.kq)("",!0),(0,o.SU)(H)?((0,l.wg)(),(0,l.iD)("p",y,[(0,l.Uk)(" Camera Off: "),(0,l._)("b",null,(0,a.zw)(te.value),1)])):(0,l.kq)("",!0),"object"===typeof t.value?((0,l.wg)(),(0,l.iD)("div",P,[(0,l.Uk)(" GPS Latitude: "),(0,l._)("strong",null,(0,a.zw)(null===(v=null===(h=t.value)||void 0===h?void 0:h.coords)||void 0===v?void 0:v.latitude),1)])):(0,l.kq)("",!0),"object"===typeof t.value?((0,l.wg)(),(0,l.iD)("div",O,[(0,l.Uk)(" GPS Longitude: "),(0,l._)("strong",null,(0,a.zw)(null===(B=null===(x=t.value)||void 0===x?void 0:x.coords)||void 0===B?void 0:B.longitude),1)])):(0,l.kq)("",!0)],2)):(0,l.kq)("",!0)])]})),_:1})}}});var E=s(9885),N=s(7691),q=s(7471),V=s(9984),$=s.n(V);const I=B,H=I;$()(B,"components",{QPage:E.Z,QChip:N.Z,QInput:q.Z})}}]);